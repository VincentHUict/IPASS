<!DOCTYPE html>
<html>
<head>
	<title>Wegwijs met Wispr</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
	<link rel="stylesheet" type="text/css" href="css/pm.css">
</head>
<body>
	
	<!-- Begin van de navbar -->
	<nav class="navbar navbar-expand-md navbar-light bg-light sticky-top shadow p-4 mb-4 bg-white">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<a class="navbar-brand" href="index.html"> 
			<img src="https://pbs.twimg.com/profile_images/1047917455555870721/WGtP2QNH.jpg" alt="projectlogo" style="width:50px; height:50px;">
		</a>

		<div class="collapse navbar-collapse" id="navbarTogglerDemo03">
			<ul class="navbar-nav mr-auto mt-2 mt-lg-0">
				<li class="nav-item">
					<a class="nav-link" href="index.html">HOME</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="howto.html">HOWTO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="faq.html">VEELGESTELDE VRAGEN</a>
				</li>
				<li class="nav-item dropdown dmenu">
					<a class="nav-link dropdown-toggle" href="pm.html" id="navbardrop" data-toggle="dropdown">PROBLEEMMELDINGEN</a>
					<div class="dropdown-menu sm-menu">
						<a class="dropdown-item" href="pm.html">MELD EEN PROBLEEM</a> 
						<a class="dropdown-item" href="pm.html">OVERZICHT</a>
					</div>
				</li>
			</ul>
		
		<!-- Dit is een zoekknop -->
		<form class="form-inline my-2 my-lg-0">
			<input class="form-control mr-sm-2" type="search" placeholder="ZOEKEN" aria-label="Search" />
			<button class="btn btn-outline-default my-2 my-sm-0 fa fa-search" type="submit"></button>			
		</form>
		<!-- Einde van de zoekknop -->
		
		</div>
	</nav>
	<!-- Einde van de navbar -->

	<div class="container-fluid padding">
		<div class="row welcome text-center">
			<div class="col-12">
				<h1 class="display-4">Probleemmeldingen</h1>
				<h2 class="display-5">Alle problemen en bijpassende oplossingen</h2>
			</div>
		</div>
	</div>
	
	<!-- Een nieuw probleem indienen -->
	<div class="container-fluid padding">
		<div class="row text-center padding">
			<div class="form-group">
				<form id="indienen">
					<p>Probleem: </p>
					<input type="number" name="probleemid" class="form-control" placeholder="Probleemnummer" id="probleemId" />	
					<input type="text" name="beschrijving" class="form-control input-lg" placeholder="Wat is het probleem?" id="beschrijving" />
					<input type="date" name="registratiedatum" class="form-control" placeholder="Datum van vandaag" id="registratieDatum" />
				</form>	
				<div id="probleemsubmit">
					<button id="probleemsubmit" class="btn btn-outline-default my-2 my-sm-0" onclick="indienen">Indienen</button>
				</div>
			</div>
		</div>
	</div>
	<!-- Einde van nieuw probleem indienen -->
	
	<div class="container-fluid padding">
		<div class="row welcome text-center">
			<div class="col-12">
				<h2 class="display-5">Overzicht</h2><br>
				<p>Overzicht van alle meldingen die bij ons bekend zijn.</p>
			</div>
		</div>
	</div>
	
	<!-- Alle problemen ophalen -->
	<table id="probleemInfo" style="text-align : center">
		<tr>
			<th>Probleem ID</th>
			<th>Beschrijving</th>
			<th>Datum gemeld</th>
		</tr>
	</table>
	<div id="GETprobleem">	
		<button id="GETprobleem" class="getprobleem" onclick="get">Geef alle problemen weer</button>
	</div>
	<!-- Eind van problemen ophalen -->
	
	<!-- Een probleem wijzigen, aan de hand van probleemid met een nieuwe beschrijving -->
	<h2 class="display-6">Wijzig uw probleem</h2>
	<form id="update" style="text-align : center; display: inline-block;">
			<input type="number" name="probleemid" id="probleemId" placeholder="ID">
			<input type="text" name="beschrijving" id="beschrijving" placeholder="Nieuwe beschrijving">
	
	<div id="updateId" style="text-align : center">
		<button id="updateId" class="updateprobleem" onclick="update">Wijzig probleem</button>
	</div>
	</form>
	<!-- Eind van wijzigen probleem -->
	
	<!-- Begin van probleem deleten -->
	<h2 class="display-6">Verwijder uw probleem</h2>		
	<form id="delete">	
		<input type="number" id="deleteId" placeholder="ID">
		<button id="deleteId" class="deleteprobleem" onclick="delete">Verwijder probleem</button>		
	</form>
	<!-- Eind van probleem verwijderen -->
	
	<!-- Extra informatie met doorverwijzingen op de webapplicatie -->
	<hr class="my-1">
	<div class="container-fluid padding">
		<div class="row text-center padding">
			<div class="col-12left2">
				<h3>Gewoon een vraag?</h3>
				<p>Vind <a href="faq.html">hier</a> alle antwoorden op je vragen.</p>
			</div>
			<div class="col-12left2">
				<h3>Liever begeleiding?</h3>
				<p>Op <a href="howto.html">deze</a> pagina vind je rondleidingen en begeleiding.</p>
			</div>
		</div>
	</div>
	<!-- Einde van de extra informatiekoppen -->

	<!-- Begin van de footer, met kopjes voor het contactinfo, inloggen en registreren -->
	<footer>
		<div class="container-fluid padding">
			<div class="row text-center">
				<div class="col-12 col-md-4 feature-1">
					<h4>Contact</h4><br>
					<p>Mail - info@wispr.tech</p>
					<p>Facebook - @WisprTech</p>
					<p>Twitter - @WisprTech</p>
				</div>
				<div class="col-12 col-md-4 feature-1">
					<h4>Inloggen</h4><br>
					<p>Wat ontzettend tof dat je al klant bent! Log nu hier in.</p>
					<a href="login.html"><button class="button">Inloggen</button></a>
				</div>
				<div class="col-12 col-md-4 feature-1">
					<h4>Registreren</h4><br>
					<p>Nog geen klant? Registreer nu!</p>
					<a href="reg.html"><button class="button">Registreren</button></a>
				</div>
			</div>
		</div>

		<div class="container-fluid padding">
			<hr class="light">
			<p class="col-12">Deze webapplicatie is mede mogelijk gemaakt door Vincent Sels, student HBO-ICT.</p>
		</div>
	</footer>
	<!-- Eind van de footer -->

	<!-- JavaScript code voor het indienen van een probleem -->
	<script>
	document.getElementById("probleemsubmit").addEventListener("click", indienen);
		
	function indienen() {
		var formData = new FormData(document.querySelector("#indienen"));
		var encData = new URLSearchParams(formData.entries());
		
		fetch("restservices/problemen/post/probleem", {method: 'POST', body: encData})
		.then((response) => {
			console.log(response)
			if (response.status != 200) {
				console.log("Error");
				alert("Geen nieuw probleem aangemaakt!")
			} else {
				console.log("Succes");
				alert("Nieuw probleem aangemaakt!")
			}
		});
	}
	</script>
	<!-- Einde van probleem indienen -->
	
	<!-- JavaScript code voor het verkrijgen van alle problemen -->
	<script>
	document.getElementById("GETprobleem").addEventListener("click", get)
	function get() {
		fetch("restservices/problemen/get/probleem")
		.then(response => response.json())
		.then(result => {
			var probleemInfo = document.getElementById('probleemInfo')
			
			console.log(result);
			
		for (let p in result) {
			console.log(p);
			
			probleemInfo.innerHTML += `
			<tr>
				<th> ${result[p].probleemid} </th>
				<th> ${result[p].beschrijving} </th>
				<th> ${result[p].registratiedatum} </th>
			</tr>
			`
		}		
	 })
	}
	</script>
	<!-- Einde van problemen ophalen -->
	
	<!-- JavaScript code voor het wijzigen van een bestaand probleem aan de hand van het id -->
	<script>
	document.getElementById("updateId").addEventListener("click", function() {
		var id = document.getElementById("probleemId").value;
		
		var formData = new FormData(document.querySelector('update'));
		var encData = new URLSearchParams(formData.entries());
		
		fetch("restservices/problemen/update/probleem/" + id, { method: 'PUT', body: encData})
		.then((response) => {
			console.log(response)
		if (response.status != 200) {
			console.log("Niet gelukt!");
		} else {
			console.log("Gelukt!");
			alert("Probleem is ge√ºpdatet");
		}	
		})
	})
	</script>
	<!-- Einde van wijzigen probleem -->
	
	<!-- JavaScript code voor het deleten van een bestaand probleem -->
	<script>
	document.getElementById("deleteId").addEventListener("click", function() {
		var id = document.querySelector("deleteId").value;
		
		fetch("restservices/problemen/delete/probleem/" + id, { method: 'DELETE'})
		.then((response) => {
			console.log(response)
		if (response.status != 200) {
			console.log("Error");
		} else {
			console.log("Gelukt!");
			alert("Probleem " + id + " verwijderd!");
		}
	 	})
	})
	</script>
	<!-- Einde van probleem verwijderen -->
</body>
</html>