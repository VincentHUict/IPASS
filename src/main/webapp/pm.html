<!DOCTYPE html>
<html>
<head>
	<title>Wegwijs met Wispr</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
	<link rel="stylesheet" type="text/css" href="css/pm.css">
</head>
<body>
	
	<nav class="navbar navbar-expand-md navbar-light bg-light sticky-top shadow p-4 mb-4 bg-white">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<a class="navbar-brand" href="index.html"> 
			<img src="https://pbs.twimg.com/profile_images/1047917455555870721/WGtP2QNH.jpg" alt="projectlogo" style="width:50px; height:50px;">
		</a>

		<div class="collapse navbar-collapse" id="navbarTogglerDemo03">
			<ul class="navbar-nav mr-auto mt-2 mt-lg-0">
				<li class="nav-item">
					<a class="nav-link" href="index.html">HOME</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="howto.html">HOWTO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="faq.html">VEELGESTELDE VRAGEN</a>
				</li>
				<li class="nav-item dropdown dmenu">
					<a class="nav-link dropdown-toggle" href="pm.html" id="navbardrop" data-toggle="dropdown">PROBLEEMMELDINGEN</a>
					<div class="dropdown-menu sm-menu">
						<a class="dropdown-item" href="pm.html">MELD EEN PROBLEEM</a> 
						<a class="dropdown-item" href="pm.html">OVERZICHT</a>
					</div>
				</li>
			</ul>

		<form class="form-inline my-2 my-lg-0">
			<input class="form-control mr-sm-2" type="search" placeholder="ZOEKEN" aria-label="Search" />
			<button class="btn btn-outline-default my-2 my-sm-0 fa fa-search" type="submit"></button>			
		</form>

		</div>
	</nav>

	<div class="container-fluid padding">
		<div class="row welcome text-center">
			<div class="col-12">
				<h1 class="display-4">Probleemmeldingen</h1>
				<h2 class="display-5">Alle problemen en bijpassende oplossingen</h2>
			</div>
		</div>
	</div>
	
	<div class="container-fluid padding">
		<div class="row text-center padding">
			<div class="form-group">
				<div id="probleem-submit">
					<label for="probleem">Probleem: </label>
					<input class="form-control input-lg" placeholder="Wat is het probleem?" id="probleem" type="text" /><br>
					<button class="btn btn-outline-default my-2 my-sm-0" type="submit" id="probleem-submit" onclick="indienen">Indienen</button>
				</div>	
			</div>
		</div>
	</div>
	
	<div class="container-fluid padding">
		<div class="row welcome text-center">
			<div class="col-12">
				<h2 class="display-5">Overzicht</h2><br>
				<p>Hier moet een overzicht komen van problemen die gemeld zijn door klanten. Nadat ze zijn aangemeld door een medewerker.</p>
				<form action="probleem">
					<button id="GETprobleem" class="getprobleem" onclick="get">Geef problemen weer</button>
					<input type="text" id="updateId" placeholder="Wijzig het probleem">
					<button id="UPDATEprobleem" class="updateprobleem" onclick="update">Wijzig probleem</button>
					<input type="number" id="deleteId" placeholder="ID">
					<button id="DELETEprobleem" class="deleteprobleem" onclick="delete">Verwijder probleem</button>
				</form>	
			</div>
		</div>
	</div>
	
	<hr class="my-1">
	<div class="container-fluid padding">
		<div class="row text-center padding">
			<div class="col-12left2">
				<h3>Gewoon een vraag?</h3>
				<p>Vind <a href="faq.html">hier</a> alle antwoorden op je vragen.</p>
			</div>
			<div class="col-12left2">
				<h3>Liever begeleiding?</h3>
				<p>Op <a href="howto.html">deze</a> pagina vind je rondleidingen en begeleiding.</p>
			</div>
		</div>
	</div>

	<footer>
		<div class="container-fluid padding">
			<div class="row text-center">
				<div class="col-12 col-md-4 feature-1">
					<h4>Contact</h4><br>
					<p>Mail - info@wispr.tech</p>
					<p>Facebook - @WisprTech</p>
					<p>Twitter - @WisprTech</p>
				</div>
				<div class="col-12 col-md-4 feature-1">
					<h4>Inloggen</h4><br>
					<p>Wat ontzettend tof dat je al klant bent! Log nu hier in.</p>
					<a href="login.html"><button class="button">Inloggen</button></a>
				</div>
				<div class="col-12 col-md-4 feature-1">
					<h4>Registreren</h4><br>
					<p>Nog geen klant? Registreer nu!</p>
					<a href="reg.html"><button class="button">Registreren</button></a>
				</div>
			</div>
		</div>

		<div class="container-fluid padding">
			<hr class="light">
			<p class="col-12">Deze webapplicatie is mede mogelijk gemaakt door Vincent Sels, student HBO-ICT.</p>
		</div>
	</footer>

	<script>
		document.getElementById("probleem-submit").addEventListener("click", indienen);
		
		function indienen() {
			var formData = new FormData(document.querySelector("#indienen"));
			var encData = new URLSearchParams(formData.entries());
			
			fetch("restservices/probleem/post", {method: 'POST', body: encData})
			.then((response) => {
				console.log(response)
				if (response.status == 403) {
					console.log("Error");
					alert("In gebruik!")
				}
				
				else if (response.status == 200) {
					console.log("Gelukt!");
					alert("Probleem ingediend!")
				}
			});
		}
	</script>
	
	<script>
		document.getElementById("GETprobleem").addEventListener("click", get)
		function get() {
			fetch("restservices/probleem/overzicht")
			.then(response => response.json())
			.then(result => {
				var probleemOverzicht = document.getElementById('probleemOverzicht')
				
				console.log(result);
				
			for (let p in result) {
				console.log(p);
				
				probleemOverzicht.innerHTML +=
					<tr>
					<td> ${result[p].probleemid}
					<td> ${result[p].beschrijving}
					<td> ${result[p].registratiedatum}
					</tr>
			}
			})
		}
	</script>
	
	<script>
		document.getElementById("UPDATEprobleem").addEventListener("click", function() {
			var id = document.getElementById("updateId").value;
			
			var formData = new FormData(document.querySelector('#probleem'));
			var encData = new URLSearchParams(formData.entries());
			
			fetch("restservices/probleem/update/" + id, { method: 'PUT', body: encData})
			.then((response) => {
				console.log(response)
			if (response.status != 200) {
				console.log("Niet gelukt!");
			} else {
				console.log("Gelukt!");
				alert("Probleem is ge√ºpdatet");
			}	
			})
		})
	</script>
	
	<script>
		document.getElementById("delete").addEventListener("click", function() {
			var id = document.querySelector("deleteId").value;
			
			fetch("restservices/probleem/delete/" + id, { method: 'DELETE'})
			.then((response) => {
				console.log(response)
				if (response.status != 200) {
					console.log("Error");
				} else {
					console.log("Gelukt!");
					alert("Probleem verwijderd!");
				}
			})
		})
	</script>
</body>
</html>